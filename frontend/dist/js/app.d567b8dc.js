(function(t){function e(e){for(var o,s,i=e[0],c=e[1],u=e[2],l=0,m=[];l<i.length;l++)s=i[l],Object.prototype.hasOwnProperty.call(a,s)&&a[s]&&m.push(a[s][0]),a[s]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(t[o]=c[o]);d&&d(e);while(m.length)m.shift()();return r.push.apply(r,u||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],o=!0,s=1;s<n.length;s++){var i=n[s];0!==a[i]&&(o=!1)}o&&(r.splice(e--,1),t=c(c.s=n[0]))}return t}var o={},s={app:0},a={app:0},r=[];function i(t){return c.p+"js/"+({}[t]||t)+"."+{"chunk-649b3e78":"61f0544f","chunk-6fedeada":"e4519c1d","chunk-89123124":"9d6cc2df","chunk-b01a1f6e":"762247dc"}[t]+".js"}function c(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.e=function(t){var e=[],n={"chunk-649b3e78":1,"chunk-6fedeada":1,"chunk-89123124":1,"chunk-b01a1f6e":1};s[t]?e.push(s[t]):0!==s[t]&&n[t]&&e.push(s[t]=new Promise((function(e,n){for(var o="css/"+({}[t]||t)+"."+{"chunk-649b3e78":"4df54e62","chunk-6fedeada":"d2284816","chunk-89123124":"019a4da9","chunk-b01a1f6e":"8a78a7be"}[t]+".css",a=c.p+o,r=document.getElementsByTagName("link"),i=0;i<r.length;i++){var u=r[i],l=u.getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(l===o||l===a))return e()}var m=document.getElementsByTagName("style");for(i=0;i<m.length;i++){u=m[i],l=u.getAttribute("data-href");if(l===o||l===a)return e()}var d=document.createElement("link");d.rel="stylesheet",d.type="text/css",d.onload=e,d.onerror=function(e){var o=e&&e.target&&e.target.src||a,r=new Error("Loading CSS chunk "+t+" failed.\n("+o+")");r.code="CSS_CHUNK_LOAD_FAILED",r.request=o,delete s[t],d.parentNode.removeChild(d),n(r)},d.href=a;var h=document.getElementsByTagName("head")[0];h.appendChild(d)})).then((function(){s[t]=0})));var o=a[t];if(0!==o)if(o)e.push(o[2]);else{var r=new Promise((function(e,n){o=a[t]=[e,n]}));e.push(o[2]=r);var u,l=document.createElement("script");l.charset="utf-8",l.timeout=120,c.nc&&l.setAttribute("nonce",c.nc),l.src=i(t);var m=new Error;u=function(e){l.onerror=l.onload=null,clearTimeout(d);var n=a[t];if(0!==n){if(n){var o=e&&("load"===e.type?"missing":e.type),s=e&&e.target&&e.target.src;m.message="Loading chunk "+t+" failed.\n("+o+": "+s+")",m.name="ChunkLoadError",m.type=o,m.request=s,n[1](m)}a[t]=void 0}};var d=setTimeout((function(){u({type:"timeout",target:l})}),12e4);l.onerror=l.onload=u,document.head.appendChild(l)}return Promise.all(e)},c.m=t,c.c=o,c.d=function(t,e,n){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)c.d(n,o,function(e){return t[e]}.bind(null,o));return n},c.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="/",c.oe=function(t){throw console.error(t),t};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],l=u.push.bind(u);u.push=e,u=u.slice();for(var m=0;m<u.length;m++)e(u[m]);var d=l;r.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"02b1":function(t,e,n){"use strict";n("7f46")},1182:function(t,e,n){},"34ba":function(t,e,n){"use strict";n("1182")},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("2b0e"),s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("vue-confirm-dialog"),n("NavBar"),n("router-view")],1)},a=[],r=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"nav"}},[o("div",{staticClass:"logo"},[o("router-link",{attrs:{to:"/"}},[o("img",{attrs:{src:n("7197"),id:"logo-groupomania"}})])],1),o("div",{attrs:{id:"nav-info"}},["/login"!==t.$route.path&&"/signup"!==t.$route.path?o("div",t._b({},"div",t.account,!1),[o("div",{staticClass:"navbar-user",attrs:{role:"link","aria-label":"Accès aux informations utilisateurs"}},[o("ul",{attrs:{id:"list"}},[o("li",[o("router-link",{staticClass:"menu",attrs:{to:"/account"}},[t._v("Informations")])],1),1==t.admin?o("li",[o("router-link",{staticClass:"menu",attrs:{to:"/allusersadmin"}},[t._v("Tous les utilisateurs")])],1):t._e(),o("li",[o("a",{staticClass:"logOut menu",attrs:{href:"#"},on:{click:function(e){return t.logOut()}}},[t._v("Se déconnecter")])])])])]):t._e()])])},i=[],c=n("bc3a"),u=n.n(c),l={name:"NavBar",data:function(){return{cookie:this.$cookies.get("token"),userPhoto:"",admin:"",account:""}},created:function(){var t=this;if(null==this.cookie)return!1;u.a.get("http://localhost:3000/api/users/me",{headers:{Authorization:"Bearer "+this.cookie}}).then((function(e){t.userPhoto=e.data.user.photo,t.admin=e.data.user.permission})).catch((function(t){console.log(t)}))},methods:{logOut:function(){var t=this;this.$confirm({message:"Êtes-vous sûr de vous déconnecter ?",button:{no:"No",yes:"Yes"},callback:function(e){e&&(t.$cookies.remove("token"),t.$router.go())}})},loadUser:function(){var t=this;if(!this.$cookies.isKey("token"))return!1;u.a.get("http://localhost:3000/api/users/me",{headers:{Authorization:"Bearer "+this.cookie}}).then((function(e){t.userPhoto=e.data.user.photo,t.admin=e.data.user.permission})).catch((function(t){console.log(t)}))}},watch:{$route:function(){this.cookie=this.$cookies.get("token"),this.loadUser()}}},m=l,d=(n("34ba"),n("2877")),h=Object(d["a"])(m,r,i,!1,null,null,null),p=h.exports,f={name:"app",components:{NavBar:p}},v=f,g=Object(d["a"])(v,s,a,!1,null,null,null),b=g.exports,C=(n("d3b7"),n("8c4f")),k=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"posts-box"}},[n("CreatePost",{on:{"load-all-posts":function(e){return t.onSubmit()}}}),n("div",t._l(t.allPosts,(function(e){return n("Post",{key:e.id,attrs:{firstName:e.User.firstName,lastName:e.User.lastName,userPhoto:e.User.photo,createdAt:e.createdAt,content:e.content,postPhoto:e.attachments},scopedSlots:t._u([null!==e.Comments?{key:"Comments",fn:function(){return[e.user_id==t.user.id||1==t.user.permission?n("div",{staticClass:"delete-post",on:{click:function(n){return t.deletePost(e.id)}}},[n("i",{staticClass:"fas fa-trash-restore"})]):t._e(),n("div",{staticClass:"commentaire"},[n("button",{on:{click:function(e){t.showComments=!t.showComments}}},[t._v("Commentaires")])]),t.showComments?n("div",{attrs:{id:"last-comment"}},t._l(e.Comments,(function(o){return n("div",{key:o.id,staticClass:"last-comment"},[n("img",{staticClass:"photo-user-comment",attrs:{src:o.User.photo}}),n("div",{staticClass:"user-comment"},[n("p",{staticClass:"name"},[t._v(t._s(o.User.firstName)+" "+t._s(o.User.lastName))]),n("p",{staticClass:"comment-content"},[t._v(t._s(o.content))]),o.user_id==t.user.id||1==t.user.permission?n("div",{staticClass:"delete",on:{click:function(n){return t.deleteComment(e.id,o.id,t.user.id,o.user_id)}}},[n("i",{staticClass:"fas fa-trash-alt"})]):t._e()])])})),0):t._e()]},proxy:!0}:null,{key:"lastCommentZone",fn:function(){return[n("div",[n("form",{staticClass:"comment"},[n("div",{staticClass:"comment-zone"},[n("img",{staticClass:"photo-user-comment",attrs:{src:t.user.photo}}),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.newComment.content,expression:"newComment.content"}],staticClass:"text-comment",attrs:{"aria-label":"Zone d'un commentaire",placeholder:"Écrire votre commentaire ici"},domProps:{value:t.newComment.content},on:{input:function(e){e.target.composing||t.$set(t.newComment,"content",e.target.value)}}})]),n("div",{staticClass:"btn-comments"},[n("button",{staticClass:"btn-post",attrs:{type:"submit","aria-label":"Publication d'un commentaire"},on:{click:function(n){return t.submitComment(e.id)}}},[t._v("Publier")])])])])]},proxy:!0}],null,!0)})})),1)],1)},_=[],y=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"createPost"}},[n("div",{attrs:{id:"user"}},[n("img",{attrs:{src:t.user.photo}}),n("div",{staticClass:"nom"},[n("p",[t._v(t._s(t.user.firstName)+" "+t._s(t.user.lastName))])])]),n("form",{attrs:{id:"form"},on:{submit:function(e){return e.preventDefault(),t.createPost(e)}}},[n("div",[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.postContent.content,expression:"postContent.content"}],staticClass:"text",attrs:{"aria-label":"Contenu texte d'un post",placeholder:"Que voulez-vous dire ?"},domProps:{value:t.postContent.content},on:{input:function(e){e.target.composing||t.$set(t.postContent,"content",e.target.value)}}})]),n("div",[n("label",[n("div",{attrs:{role:"button","aria-label":"Téléchargement d'un fichier"}},[t.postContent.attachments?n("span",[t._v("Fichier séléctionné : "+t._s(t.postContent.attachments.name))]):n("span",[t._v("Ajouter un fichier")])]),n("input",{ref:"photo",staticClass:"upload",attrs:{type:"file"},on:{change:function(e){return t.handleFileUpload()}}})]),n("div",[n("input",{staticClass:"publier",attrs:{type:"submit",value:"Publier","aria-label":"Publication d'un post"},on:{click:function(e){return t.loadAllPosts()}}})])])])])},P=[],w=(n("b0c0"),{name:"NewPost",props:{submit:Function},data:function(){return{cookie:this.$cookies.get("token"),user:"",userPhoto:"",postContent:{content:null,attachments:null}}},created:function(){var t=this;u.a.get("http://localhost:3000/api/users/me",{headers:{Authorization:"Bearer "+this.cookie}}).then((function(e){t.user=e.data.user})).catch((function(t){console.log(t)}))},methods:{createPost:function(){var t=this;if(null===this.postContent.content)return!1;if(null!==this.postContent.attachments){var e=new FormData;e.append("content",this.postContent.content),e.append("attachments",this.postContent.attachments,this.postContent.attachments.name),u.a.post("http://localhost:3000/api/posts",e,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+this.cookie}}).then((function(e){console.log(e),t.$router.go("/")})).catch((function(t){console.log(t)}))}else{var n=new FormData;n.append("content",this.postContent.content),u.a.post("http://localhost:3000/api/posts",n,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+this.cookie}}).then((function(e){console.log(e),t.$router.go("/")})).catch((function(t){console.log(t)}))}},uploadImage:function(){console.log("Image Téléchargée !")},loadAllPosts:function(){this.$emit("load-all-posts")},handleFileUpload:function(){this.postContent.attachments=this.$refs.photo.files[0]}}}),A=w,$=(n("658b"),Object(d["a"])(A,y,P,!1,null,null,null)),N=$.exports,x=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"post"}},[n("div",[n("div",{staticClass:"user"},[n("img",{attrs:{src:t.userPhoto}}),n("h1",[t._v(" "+t._s(t.firstName)+" "+t._s(t.lastName)+" ")])]),n("div",{staticClass:"date"},[n("p",[t._v(t._s(t._f("moment")(t.createdAt,"ddd, hA")))])])]),n("div",{staticClass:"content"},[n("p",[t._v(" "+t._s(t.content))]),n("img",{attrs:{src:t.postPhoto}})]),t._t("Comments"),t._t("lastCommentZone")],2)},S=[],O={name:"Post",data:function(){return{}},props:{firstName:{type:String,default:""},lastName:{type:String,default:""},userPhoto:{type:String,default:""},createdAt:{type:String,default:"2 heures"},content:{type:String,default:"This is my first message !"},myUserPhoto:{type:String,default:""},postId:{type:String},postPhoto:{type:String},newCommentContent:{type:String}}},B=O,j=(n("02b1"),Object(d["a"])(B,x,S,!1,null,null,null)),T=j.exports,E={name:"Home",components:{CreatePost:N,Post:T},data:function(){return{cookie:this.$cookies.get("token"),allPosts:"",post:{user_id:"",createdAt:"",content:"",id:"",attachments:"",Comments:[]},postContent:{content:null,attachments:null},comment:{content:"",user_id:""},newComment:{content:""},user:{photo:""},showComments:!1}},created:function(){var t=this;u.a.get("http://localhost:3000/api/posts",{headers:{Authorization:"Bearer "+this.cookie}}).then((function(e){console.log("posts",e.data),t.allPosts=e.data})).catch((function(t){console.log(t)})),u.a.get("http://localhost:3000/api/users/me",{headers:{Authorization:"Bearer "+this.cookie}}).then((function(e){t.user=e.data.user,console.log(t.user)})).catch((function(t){return console.log(t)}))},methods:{deletePost:function(t){var e=this;this.$confirm({message:"Supprimer cette publication ?",button:{no:"Non",yes:"Oui"},callback:function(n){n&&u.a.delete("http://localhost:3000/api/posts/"+t,{headers:{Authorization:"Bearer "+e.cookie}}).then((function(t){console.log(t),e.loadPosts()})).catch((function(t){window.alert(t)}))}})},loadPosts:function(){var t=this;u.a.get("http://localhost:3000/api/posts",{headers:{Authorization:"Bearer "+this.cookie}}).then((function(e){console.log("posts",e.data),t.allPosts=e.data})).catch((function(t){console.log(t)}))},onSubmit:function(){var t=document.getElementById("post-area")._value;if(console.log(t),null===t)return alert("Remplissez le champs texte de votre post !"),!1;this.$router.go()},submitComment:function(t){var e=this,n=this.newComment;console.log(n),u.a.post("http://localhost:3000/api/posts/"+t+"/comments",n,{headers:{Authorization:"Bearer "+this.cookie}}).then((function(t){console.log(t),e.$router.go()})).catch((function(t){return console.log(t)}))},deleteComment:function(t,e,n,o){var s=this;console.log(n,o),this.$confirm({message:"Supprimer ce commentaire ?",button:{no:"Non",yes:"Oui"},callback:function(n){n&&u.a.delete("http://localhost:3000/api/posts/"+t+"/comments/"+e,{headers:{Authorization:"Bearer "+s.cookie}}).then((function(t){console.log(t),s.loadPosts()})).catch((function(t){window.alert(t)}))}})}}},z=E,U=(n("cccb"),Object(d["a"])(z,k,_,!1,null,null,null)),L=U.exports,F="token",q={getToken:function(){return window.$cookies.get(F)},saveToken:function(t){window.$cookies.set(F,t)},removeToken:function(){window.$cookies.remove(F)}};o["default"].use(C["a"]);var I=[{path:"/",name:"Home",meta:{requireAuth:!0},component:L},{path:"/login",name:"Login",meta:{public:!0,onlyWhenLoggedOut:!0},component:function(){return n.e("chunk-6fedeada").then(n.bind(null,"a55b"))}},{path:"/signup",name:"Signup",meta:{public:!0,onlyWhenLoggedOut:!0},component:function(){return n.e("chunk-b01a1f6e").then(n.bind(null,"34c3"))}},{path:"/account",name:"Account",meta:{requireAuth:!0},component:function(){return n.e("chunk-89123124").then(n.bind(null,"77be"))}},{path:"/allusersadmin",name:"All Users",meta:{requireAuth:!0},component:function(){return n.e("chunk-649b3e78").then(n.bind(null,"dcdc"))}}],D=new C["a"]({mode:"history",routes:I});D.beforeEach((function(t,e,n){t.meta.requireAuth?q.getToken()?n():n("/login"):n()}));var M=D,H=n("2b27"),Z=n.n(H),J=n("d30b"),K=n.n(J);o["default"].use(Z.a),o["default"].use(K.a),o["default"].use(n("2ead")),new o["default"]({router:M,render:function(t){return t(b)}}).$mount("#app"),o["default"].component("vue-confirm-dialog",K.a.default)},"5ced":function(t,e,n){},"658b":function(t,e,n){"use strict";n("75d2")},7197:function(t,e,n){t.exports=n.p+"img/logo-groupomania.7bfa4958.png"},"75d2":function(t,e,n){},"7f46":function(t,e,n){},cccb:function(t,e,n){"use strict";n("5ced")}});
//# sourceMappingURL=app.d567b8dc.js.map